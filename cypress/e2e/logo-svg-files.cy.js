const MARK_PATHS = {
  arc: 'M26.37 82.36c4.25-5.42 10.87-8.91 18.29-8.91s14.04 3.49 18.29 8.91h26.37C83.26 63.47 65.56 49.8 44.66 49.8 23.76 49.8 6.05 63.47 0 82.36h26.37z',
  'stem-left': 'M25.38 82.36 57.34 0H31.97L0 82.36z',
  'stem-right': 'M89.32 82.36 57.35 0H31.97l31.97 82.36z',
  'arc-overlap':
    'M87.3 77.16C80.81 63 67.46 52.64 51.5 50.3l12.44 32.06h25.38l-2.02-5.2z'
}
const TEXT_PATHS = {
  wordmark:
    'm116.14 46.2-1.99 5.89h-5.94l10.26-29.43h7.08l10.26 29.43h-5.94l-1.99-5.89h-11.74zm5.85-17.3-4.11 12.09h8.23l-4.12-12.09zM151.17 35.26c-2.25-.25-4.11 0-5.39 1.36-1.19 1.23-1.4 3.01-1.4 4.75V52.1h-5.6V30.26h5.34v2.16c1.78-2.2 4.41-3.01 7.04-2.59v5.43zM164.02 52.61c-6.57 0-11.28-5.09-11.28-11.41s4.71-11.49 11.28-11.49c5.26 0 9.24 2.97 10.52 7.89h-5.98c-.76-1.48-2.5-2.76-4.54-2.76-3.1 0-5.6 2.88-5.6 6.4 0 3.43 2.5 6.28 5.6 6.28 2.08 0 3.86-1.27 4.58-2.8h5.98c-1.27 4.96-5.26 7.89-10.56 7.89zM197.77 52.1h-5.6V39.33c0-1.27-.42-4.16-4.07-4.16-2.5 0-4.24 1.7-4.24 4.16V52.1h-5.64V20.55h5.64v10.86c1.4-1.06 3.09-1.7 5-1.7 5.34 0 8.91 3.86 8.91 9.63V52.1zM208.42 27.89h-5.6v-5.22h5.6v5.22zm0 24.21h-5.6V30.26h5.6V52.1zM225.42 52.1h-6.02l-8.27-21.84h5.85l5.43 16.28 5.47-16.28h5.77l-8.23 21.84zM240.01 43.36c.72 2.67 2.84 4.33 5.47 4.33 1.87 0 3.69-.81 4.62-2.54h5.98c-1.27 4.45-5.13 7.46-10.56 7.46-6.15 0-11.19-5.09-11.19-11.41s5.05-11.49 11.19-11.49c6.45 0 11.79 5 10.98 13.65h-16.49zm10.95-4.58c-.68-2.54-2.8-4.16-5.47-4.16-2.54 0-4.58 1.61-5.39 4.16h10.86zM269.27 52.61c-5.55 0-9.67-2.93-10.35-7.63h5.68c.76 1.87 3.01 2.54 4.66 2.54 2.25 0 3.94-.68 3.94-1.95 0-1.23-.76-1.74-4.58-2.33-3.9-.59-9.12-1.65-9.12-6.53 0-3.44 3.01-7 9.33-7 5 0 8.74 2.71 9.46 6.83h-5.81c-.34-1.02-1.57-1.82-3.65-1.82-2.59 0-3.65.93-3.65 1.74 0 1.14 1.61 1.53 4.33 1.95 5.43.89 9.33 2.08 9.33 6.83.02 4.31-3.97 7.37-9.57 7.37zM292.81 52.61c-6.79 0-11.24-3.94-11.24-9.84h3.73c0 3.94 3.05 6.4 7.51 6.4 5.05 0 7.5-2.12 7.5-5.43 0-2.46-1.1-4.16-7.59-5.26-6.53-1.15-10.26-3.18-10.26-8.23 0-5.05 4.03-8.31 10.26-8.31 6.45 0 10.43 3.48 10.43 9.16h-3.65c0-3.43-2.33-5.72-6.74-5.72-4.54 0-6.66 1.99-6.66 4.75 0 2.54 1.36 3.82 7.38 4.92 6.45 1.23 10.43 3.05 10.43 8.69.01 5.77-4.53 8.87-11.1 8.87zM319.65 52.61c-3.14 0-5.85-1.7-7.42-3.82v13.02h-3.6V30.26h3.48v3.48c1.53-2.2 4.33-4.03 7.55-4.03 6.28 0 10.9 5.13 10.9 11.41-.01 6.36-4.63 11.49-10.91 11.49zm0-19.59c-4.03 0-7.42 3.65-7.42 8.1 0 4.5 3.39 8.18 7.42 8.18 4.07 0 7.29-3.69 7.29-8.18.01-4.46-3.22-8.1-7.29-8.1zM349.84 49.6c-1.57 1.91-4.11 3.01-7.51 3.01-4.5 0-8.52-2.03-8.52-6.74 0-4.49 3.27-6.53 8.91-6.83 5.34-.25 7.08-1.23 7.08-2.97 0-1.74-1.65-3.05-5.34-3.05-2.29 0-5.3.72-5.68 3.9h-3.73c.25-4.37 3.86-7.21 9.46-7.21 5.85 0 8.82 2.71 8.82 6.79v12.04c0 1.1.3 2.71.64 3.56h-3.56c-.32-.64-.53-1.49-.57-2.5zm-.04-9.25c-1.44 1.27-4.03 1.57-6.62 1.74-4.75.3-5.81 1.95-5.81 3.77 0 2.37 2.29 3.39 5.09 3.39 3.73 0 7.25-1.61 7.34-5.55v-3.35zM368.75 52.61c-6.02 0-10.94-5.09-10.94-11.41s4.92-11.49 10.94-11.49c4.88 0 8.69 2.88 10.18 7.29h-3.86c-1.23-2.38-3.48-3.99-6.32-3.99-4.03 0-7.34 3.69-7.34 8.18 0 4.5 3.31 8.1 7.34 8.1 2.88 0 5.13-1.61 6.32-3.99h3.86c-1.44 4.42-5.3 7.31-10.18 7.31zM403.14 45.31c-1.53 4.66-5.26 7.29-10.3 7.29-6.28 0-11.19-5-11.19-11.41 0-6.32 4.92-11.49 10.98-11.49 5.64 0 11.07 4.66 11.03 12.42H385.3c.47 4.54 3.94 7.21 7.55 7.21 3.1 0 5.3-1.48 6.49-4.03h3.8zm-3.47-6.4c-.89-3.56-3.86-5.94-7.04-5.94-3.01 0-6.19 2.21-7.12 5.94h14.16zM315.19 83.93c-.82 2.19-2.11',
  descriptor:
    'M 115.2,62.98 V 82 h 2.85 V 62.98 h 7.14 v -2.4 h -17.13 v 2.4 z m 19.37998,9.78 h -8.91 q 0.06,-0.9 0.39,-1.68 0.33,-0.81 0.9,-1.41 0.57,-0.6 1.35,-0.93 0.81,-0.36 1.8,-0.36 0.96,0 1.74,0.36 0.81,0.33 1.38,0.93 0.6,0.57 0.93,1.38 0.36,0.81 0.42,1.71 z m 2.46,4.32 h -2.52 q -0.33,1.53 -1.38,2.28 -1.02,0.75 -2.64,0.75 -1.26,0 -2.19,-0.42 -0.93,-0.42 -1.53,-1.11 -0.6,-0.72 -0.87,-1.62 -0.27,-0.93 -0.24,-1.95 h 11.61 q 0.06,-1.41 -0.27,-2.97 -0.3,-1.56 -1.14,-2.88 -0.81,-1.32 -2.19,-2.16 -1.35,-0.87 -3.42,-0.87 -1.59,0 -2.94,0.6 -1.32,0.6 -2.31,1.68 -0.96,1.08 -1.5,2.55 -0.54,1.47 -0.54,3.24 0.06,1.77 0.51,3.27 0.48,1.5 1.41,2.58 0.93,1.08 2.28,1.68 1.38,0.6 3.24,0.6 2.64,0 4.38,-1.32 1.74,-1.32 2.25,-3.93 z M 150.45,71.47 h 2.64 q -0.15,-1.38 -0.72,-2.37 -0.57,-1.02 -1.47,-1.68 -0.87,-0.66 -2.04,-0.96 -1.14,-0.33 -2.46,-0.33 -1.83,0 -3.21,0.66 -1.38,0.63 -2.31,1.77 -0.9,1.11 -1.35,2.64 -0.45,1.5 -0.45,3.24 0,1.74 0.45,3.21 0.48,1.44 1.38,2.49 0.93,1.05 2.28,1.62 1.38,0.57 3.15,0.57 2.97,0 4.68,-1.56 1.74,-1.56 2.16,-4.44 h -2.61 q -0.24,1.8 -1.32,2.79 -1.05,0.99 -2.94,0.99 -1.2,0 -2.07,-0.48 -0.87,-0.48 -1.41,-1.26 -0.54,-0.81 -0.81,-1.83 -0.24,-1.02 -0.24,-2.1 0,-1.17 0.24,-2.25 0.24,-1.11 0.78,-1.95 0.57,-0.84 1.5,-1.35 0.93,-0.51 2.31,-0.51 1.62,0 2.58,0.81 0.96,0.81 1.26,2.28 z m 5.58002,-10.89 V 82 h 2.55 v -8.76 q 0,-1.05 0.27,-1.92 0.3,-0.9 0.87,-1.56 0.57,-0.66 1.41,-1.02 0.87,-0.36 2.04,-0.36 1.47,0 2.31,0.84 0.84,0.84 0.84,2.28 V 82 h 2.55 V 71.8 q 0,-1.26 -0.27,-2.28 -0.24,-1.05 -0.87,-1.8 -0.63,-0.75 -1.65,-1.17 -1.02,-0.42 -2.55,-0.42 -0.69,0 -1.44,0.15 -0.72,0.15 -1.41,0.48 -0.66,0.3 -1.2,0.81 -0.54,0.48 -0.84,1.2 h -0.06 V 60.58 Z M 175.98001,79.6 V 62.98 h 4.8 q 1.98,0 3.33,0.57 1.35,0.54 2.19,1.62 0.87,1.05 1.23,2.58 0.39,1.5 0.39,3.42 0,1.98 -0.42,3.39 -0.39,1.38 -1.02,2.31 -0.63,0.93 -1.44,1.47 -0.78,0.54 -1.59,0.84 -0.81,0.27 -1.53,0.36 -0.72,0.06 -1.2,0.06 z m -2.85,-19.02 V 82 h 7.35 q 2.67,0 4.62,-0.75 1.95,-0.75 3.21,-2.16 1.26,-1.44 1.86,-3.51 0.6,-2.1 0.6,-4.8 0,-5.16 -2.67,-7.68 -2.67,-2.52 -7.62,-2.52 z m 22.56002,13.68 q 0,-1.41 0.36,-2.49 0.39,-1.11 1.05,-1.86 0.66,-0.75 1.53,-1.14 0.9,-0.39 1.89,-0.39 0.99,0 1.86,0.39 0.9,0.39 1.56,1.14 0.66,0.75 1.02,1.86 0.39,1.08 0.39,2.49 0,1.41 -0.39,2.52 -0.36,1.08 -1.02,1.83 -0.66,0.72 -1.56,1.11 -0.87,0.39 -1.86,0.39 -0.99,0 -1.89,-0.39 -0.87,-0.39 -1.53,-1.11 -0.66,-0.75 -1.05,-1.83 -0.36,-1.11 -0.36,-2.52 z m -2.7,0 q 0,1.71 0.48,3.18 0.48,1.47 1.44,2.58 0.96,1.08 2.37,1.71 1.41,0.6 3.24,0.6 1.86,0 3.24,-0.6 1.41,-0.63 2.37,-1.71 0.96,-1.11 1.44,-2.58 0.48,-1.47 0.48,-3.18 0,-1.71 -0.48,-3.18 -0.48,-1.5 -1.44,-2.58 -0.96,-1.11 -2.37,-1.74 -1.38,-0.63 -3.24,-0.63 -1.83,0 -3.24,0.63 -1.41,0.63 -2.37,1.74 -0.96,1.08 -1.44,2.58 -0.48,1.47 -0.48,3.18 z M 221.58,71.47 h 2.64 q -0.15,-1.38 -0.72,-2.37 -0.57,-1.02 -1.47,-1.68 -0.87,-0.66 -2.04,-0.96 -1.14,-0.33 -2.46,-0.33 -1.83,0 -3.21,0.66 -1.38,0.63 -2.31,1.77 -0.9,1.11 -1.35,2.64 -0.45,1.5 -0.45,3.24 0,1.74 0.45,3.21 0.48,1.44 1.38,2.49 0.93,1.05 2.28,1.62 1.38,0.57 3.15,0.57 2.97,0 4.68,-1.56 1.74,-1.56 2.16,-4.44 h -2.61 q -0.24,1.8 -1.32,2.79 -1.05,0.99 -2.94,0.99 -1.2,0 -2.07,-0.48 -0.87,-0.48 -1.41,-1.26 -0.54,-0.81 -0.81,-1.83 -0.24,-1.02 -0.24,-2.1 0,-1.17 0.24,-2.25 0.24,-1.11 0.78,-1.95 0.57,-0.84 1.5,-1.35 0.93,-0.51 2.31,-0.51 1.62,0 2.58,0.81 0.96,0.81 1.26,2.28 z m 7.14003,5.64 h -2.55 q 0.06,1.44 0.6,2.46 0.54,0.99 1.44,1.62 0.9,0.6 2.07,0.87 1.17,0.27 2.46,0.27 1.17,0 2.34,-0.24 1.2,-0.21 2.13,-0.78 0.96,-0.57 1.53,-1.5 0.6,-0.93 0.6,-2.34 0,-1.11 -0.45,-1.86 -0.42,-0.75 -1.14,-1.23 -0.69,-0.51 -1.62,-0.81 -0.9,-0.3 -1.86,-0.51 -0.9,-0.21 -1.8,-0.39 -0.9,-0.21 -1.62,-0.48 -0.72,-0.3 -1.2,-0.72 -0.45,-0.45 -0.45,-1.11 0,-0.6 0.3,-0.96 0.3,-0.39 0.78,-0.6 0.48,-0.24 1.05,-0.33 0.6,-0.09 1.17,-0.09 0.63,0 1.23,0.15 0.63,0.12 1.14,0.42 0.51,0.3 0.84,0.81 0.33,0.48 0.39,1.23 h 2.55 q -0.09,-1.41 -0.6,-2.34 -0.51,-0.96 -1.38,-1.5 -0.84,-0.57 -1.95,-0.78 -1.11,-0.24 -2.43,-0.24 -1.02,0 -2.07,0.27 -1.02,0.24 -1.86,0.78 -0.81,0.51 -1.35,1.35 -0.51,0.84 -0.51,2.01 0,1.5 0.75,2.34 0.75,0.84 1.86,1.32 1.14,0.45 2.46,0.72 1.32,0.24 2.43,0.57 1.14,0.3 1.89,0.81 0.75,0.51 0.75,1.5 0,0.72 -0.36,1.2 -0.36,0.45 -0.93,0.69 -0.54,0.24 -1.2,0.33 -0.66,0.09 -1.26,0.09 -0.78,0 -1.53,-0.15 -0.72,-0.15 -1.32,-0.48 -0.57,-0.36 -0.93,-0.93 -0.36,-0.6 -0.39,-1.44 z'
}
const FULL_LOGO_FILES = [
  'src/images/logo-full-dark.svg',
  'src/images/logo-full-light.svg'
]
const ALL_LOGO_FILES = [...FULL_LOGO_FILES, 'src/images/logo-mark.svg']

describe('Logo SVG files', () => {
  it('have correct mark paths and order', () => {
    ALL_LOGO_FILES.forEach((file) => {
      cy.readFile(file).then((content) => {
        const expectedOrder = Object.keys(MARK_PATHS)
        const order = extractPathOrder(content, expectedOrder)

        expect(
          order,
          `${file}: mark paths should appear in correct order for layering`
        ).to.deep.equal(expectedOrder)

        const paths = extractPaths(content, Object.keys(MARK_PATHS))

        Object.entries(MARK_PATHS).forEach(([className, expectedPath]) => {
          expect(
            paths[className],
            `${file}: .${className} path should match source of truth`
          ).to.equal(expectedPath)
        })
      })
    })
  })

  describe('full logo variants', () => {
    it('have correct text paths and order', () => {
      FULL_LOGO_FILES.forEach((file) => {
        cy.readFile(file).then((content) => {
          const expectedOrder = Object.keys(TEXT_PATHS)
          const order = extractPathOrder(content, expectedOrder)

          expect(
            order,
            `${file}: text paths should appear in correct order`
          ).to.deep.equal(expectedOrder)

          const paths = extractPaths(content, Object.keys(TEXT_PATHS))

          Object.entries(TEXT_PATHS).forEach(([className, expectedPath]) => {
            expect(
              paths[className],
              `${file}: .${className} path should match source of truth`
            ).to.equal(expectedPath)
          })
        })
      })
    })
  })
})

/**
 * Parses SVG content and extracts the `d` attribute from path elements with
 * the specified class names
 *
 * @param {string} content - The SVG file contents as a string.
 * @param {string[]} classNames - An array of class names to search for in the SVG's path elements.
 * @returns {Object} An object mapping each class name to its corresponding path's `d` attribute value, if found.
 */
function extractPaths(content, classNames) {
  const parser = new DOMParser()
  const svg = parser.parseFromString(content, 'image/svg+xml')
  const paths = {}

  classNames.forEach((className) => {
    const el = svg.querySelector(`.${className}`)

    if (el) {
      paths[className] = el.getAttribute('d')
    }
  })

  return paths
}

/**
 * Parses SVG content and extracts the order of paths by their classes
 *
 * @param {string} content - The SVG file contents as a string.
 * @param {string[]} classNames - An array of class names to check for ordering.
 * @returns {string[]} An array of class names representing their order of appearance in the SVG.
 */
function extractPathOrder(content, classNames) {
  const parser = new DOMParser()
  const svg = parser.parseFromString(content, 'image/svg+xml')
  const allPaths = svg.querySelectorAll('path')
  const order = []

  allPaths.forEach((path) => {
    const classAttr = path.getAttribute('class')
    if (classAttr) {
      const matchedClass = classNames.find((c) => classAttr === c)
      if (matchedClass) {
        order.push(matchedClass)
      }
    }
  })

  return order
}
