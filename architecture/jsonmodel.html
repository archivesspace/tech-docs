<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>tech-docs | Technical documentation for ArchivesSpace</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="tech-docs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Technical documentation for ArchivesSpace" />
<meta property="og:description" content="Technical documentation for ArchivesSpace" />
<meta property="og:site_name" content="tech-docs" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="tech-docs" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Technical documentation for ArchivesSpace","headline":"tech-docs","url":"/tech-docs/architecture/jsonmodel.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/tech-docs/assets/css/style.css?v=">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/tech-docs/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <style>
  /* Styles via https://getbootstrap.com/docs/5.3/components/alerts/#icons */
  .deprecation-alert {
    display: flex;
    align-items: center;
    padding: 1rem;
    margin-bottom: 1.5rem;
    color: #58151c;
    background-color: #f8d7da;
    border: 1px solid #f1aeb5;
    border-radius: 0.375rem;
  }
  .deprecation-alert__svg {
    flex-shrink: 0 !important;
    width: 1em;
    height: 1em;
    margin-right: 0.5rem !important;
    fill: currentcolor;
  }
</style>

<aside class="deprecation-alert">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    id="exclamation-triangle-fill"
    viewBox="0 0 16 16"
    class="deprecation-alert__svg"
    role="img"
    aria-label="Danger:"
  >
    <path
      d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
    />
  </svg>

  <p style="margin-bottom: 0">
    <em style="margin-right: 0.25rem; font-weight: 700">NOTE!</em> We recently
    launched a
    <a href="https://docs.archivesspace.org"
      >new technical documentation site</a
    >
    as part of the ArchivesSpace v4.0.0 release.
    <br />
    For now both sites will be live, but we encourage you to take a look at the
    new site and leave feedback or suggestions.
  </p>
</aside>


      <header>
        <h1><a href="/tech-docs/">tech-docs</a></h1>

        

        <p>Technical documentation for ArchivesSpace</p>

        
        <p class="view"><a href="https://github.com/archivesspace/tech-docs">View the Project on GitHub <small>archivesspace/tech-docs</small></a></p>
        

        

        

        <p>
          <a
            href="https://github.com/archivesspace/tech-docs/edit/master/architecture/jsonmodel.md"
            title="Edit architecture/jsonmodel.md on GitHub"
          >
            Edit this page on GitHub
            <small>architecture/jsonmodel.md</small>
          </a>
        </p>

        <p>
          <a
            href="https://archivesspace.atlassian.net/jira/software/projects/TD/issues"
            title="Report issue with architecture/jsonmodel.md on Jira"
          >
            Report issue on Jira
            <small>architecture/jsonmodel.md</small>
          </a>
        </p>
      </header>
      <section>

      <h1 id="jsonmodel--a-validated-archivesspace-record">JSONModel – a validated ArchivesSpace record</h1>

<p>The ArchivesSpace system is concerned with managing a number of
different archival record types.  Each record can be expressed as a
set of nested key/value pairs, and associated with each record type is
a number of rules that describe what it means for a record of that
type to be valid:</p>

<ul>
  <li>some fields are mandatory, some optional</li>
  <li>some fields can only take certain types</li>
  <li>some fields can only take values from a constrained set</li>
  <li>some fields are dependent on other fields</li>
  <li>some record types can be nested within other record types</li>
  <li>some record types may be related to others through a hierarchy</li>
  <li>some record types form a relationship graph with other record
types</li>
</ul>

<p>The JSONModel class provides a common language for expressing these
rules that all parts of the application can share.  There is a
JSONModel class instance for each type of record in the system, so:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JSONModel(:digital_object)
</code></pre></div></div>

<p>is a class that knows how to take a hash of properties and make sure
those properties conform to the specification of a Digital Object:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>JSONModel(:digital_object).from_hash(myhash)
</code></pre></div></div>

<p>If it passes validation, a new JSONModel(:digital_object) instance is
returned, which provides accessors for accessing its values, and
facilities for round-tripping between JSON documents and regular Ruby
hashes:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> obj = JSONModel(:digital_object).from_hash(myhash)

 obj.title  # or obj['title']
 obj.title = 'a new title'  # or obj['title'] = 'a new title'

 obj.\_exceptions  # Validates the object and reports any issues

 obj.to_hash  # Turn the JSONModel object back into a regular hash
 obj.to_json  # Serialize the JSONModel object into JSON
</code></pre></div></div>

<p>Much of the validation performed by JSONModel is provided by the JSON
schema definitions listed in the <code class="language-plaintext highlighter-rouge">common/schemas</code> directory.  JSON
schemas provide a standard way of declaring which properties a record
may and may not contain, along with their types and other
restrictions.  ArchivesSpace uses these schemas to capture the
validation rules defining each record type in a declarative and
relatively self-documenting fashion.</p>

<p>JSONModel instances are the primary data interchange mechanism for the
ArchivesSpace system: the API consumes and produces JSONModel
instances (in JSON format), and much of the user interface’s life is
spent turning forms into JSONModel instances and shipping them off to
the backend.</p>

<h2 id="jsonmodelclient--a-high-level-api-for-interacting-with-the-archivesspace-backend">JSONModel::Client – A high-level API for interacting with the ArchivesSpace backend</h2>

<p>To save the need for a lot of HTTP request wrangling, ArchivesSpace
ships with a module called JSONModel::Client that simplifies the
common CRUD-style operations.  Including this module just requires
passing an additional parameter when initializing JSONModel:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> JSONModel::init(:client_mode =&gt; true, :url =&gt; @backend_url)
 include JSONModel
</code></pre></div></div>

<p>If you’ll be working against a single repository, it’s convenient to
set it as the default for subsequent actions:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> JSONModel.set_repository(123)
</code></pre></div></div>

<p>Then, several additional JSONModel methods are available:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # As before, get a paginated list of accessions (GET)
 JSONModel(:accession).all(:page =&gt; 1)

 # Create a new accession (POST)
 obj = JSONModel(:accession).from_hash(:title =&gt; "A new accession", ...)
 obj.save

 # Get a single accession by ID (GET)
 obj = JSONModel(:accession).find(123)

 # Update an existing accession (POST)
 obj = JSONModel(:accession).find(123)
 obj.title = "Updated title"
 obj.save
</code></pre></div></div>


      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/archivesspace">ArchivesSpace</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/tech-docs/assets/js/scale.fix.js"></script>
  </body>
</html>
