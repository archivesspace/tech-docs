<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>tech-docs | Technical documentation for ArchivesSpace</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="tech-docs" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Technical documentation for ArchivesSpace" />
<meta property="og:description" content="Technical documentation for ArchivesSpace" />
<meta property="og:site_name" content="tech-docs" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="tech-docs" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Technical documentation for ArchivesSpace","headline":"tech-docs","url":"/tech-docs/architecture/backend/database.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/tech-docs/assets/css/style.css?v=">
    <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/tech-docs/favicon.ico" -->

<!-- end custom head snippets -->

  </head>
  <body>
    <div class="wrapper">
      <style>
  /* Styles via https://getbootstrap.com/docs/5.3/components/alerts/#icons */
  .deprecation-alert {
    display: flex;
    align-items: center;
    padding: 1rem;
    margin-bottom: 1.5rem;
    color: #58151c;
    background-color: #f8d7da;
    border: 1px solid #f1aeb5;
    border-radius: 0.375rem;
  }
  .deprecation-alert__svg {
    flex-shrink: 0 !important;
    width: 1em;
    height: 1em;
    margin-right: 0.5rem !important;
    fill: currentcolor;
  }
</style>

<aside class="deprecation-alert">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    id="exclamation-triangle-fill"
    viewBox="0 0 16 16"
    class="deprecation-alert__svg"
    role="img"
    aria-label="Danger:"
  >
    <path
      d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
    />
  </svg>

  <p style="margin-bottom: 0">
    <em style="margin-right: 0.25rem; font-weight: 700">NOTE!</em> We recently
    launched a
    <a href="https://docs.archivesspace.org"
      >new technical documentation site</a
    >
    as part of the ArchivesSpace v4.0.0 release.
    <br />
    For now both sites will be live, but we encourage you to take a look at the
    new site and leave feedback or suggestions.
  </p>
</aside>


      <header>
        <h1><a href="/tech-docs/">tech-docs</a></h1>

        

        <p>Technical documentation for ArchivesSpace</p>

        
        <p class="view"><a href="https://github.com/archivesspace/tech-docs">View the Project on GitHub <small>archivesspace/tech-docs</small></a></p>
        

        

        

        <p>
          <a
            href="https://github.com/archivesspace/tech-docs/edit/master/architecture/backend/database.md"
            title="Edit architecture/backend/database.md on GitHub"
          >
            Edit this page on GitHub
            <small>architecture/backend/database.md</small>
          </a>
        </p>

        <p>
          <a
            href="https://archivesspace.atlassian.net/jira/software/projects/TD/issues"
            title="Report issue with architecture/backend/database.md on Jira"
          >
            Report issue on Jira
            <small>architecture/backend/database.md</small>
          </a>
        </p>
      </header>
      <section>

      <h1 id="working-with-the-archivesspace-database">Working with the ArchivesSpace Database</h1>

<p>The ArchivesSpace database stores all data that is created within an ArchivesSpace instance. As described in other sections of this documentation, the backend code - particularly the model layer and <code class="language-plaintext highlighter-rouge">ASModel_crud.rb</code> file - uses the <code class="language-plaintext highlighter-rouge">Sequel</code> database toolkit to bridge the gap between this underlying data and the JSON objects which are exchanged by the other components of the system.</p>

<p>Often, querying the database directly is the most efficient and powerful way to retrieve data from ArchivesSpace. It is also possible to use raw SQL queries to create custom reports that can be run by users in the staff interface. Please consult the <a href="../../customization/reports.html">Custom Reports</a> section of this documentation for additional information on creating custom reports.</p>

<!-- .See this [plugin](link-to-plugin) for an example. Also  -->

<p>It is recommended that ArchivesSpace be run against MySQL in production, not the included demo database. Instructions on setting up ArchivesSpace to run against MySQL are <a href="../../provisioning/mysql.html">here</a>.</p>

<p>The examples in this section are written for MySQL. There are many freely-available tutorials on the internet which can provide guidance to those unfamiliar with MySQL query syntax and the features of the language.</p>

<p><strong>NOTE</strong>: the documentation below is current through database schema version 129, application version 2.7.1.</p>

<h2 id="database-overview">Database Overview</h2>

<p>The ArchivesSpace database schema and it’s mapping to the JSONModel objects used by the other parts of the system is defined by the files in the <code class="language-plaintext highlighter-rouge">common/schemas</code> and <code class="language-plaintext highlighter-rouge">backend/models</code> directories. The database itself is created via the <code class="language-plaintext highlighter-rouge">setup-database</code> script in the <code class="language-plaintext highlighter-rouge">scripts</code> directory. This script runs the migrations in the <code class="language-plaintext highlighter-rouge">common/db/migrations</code> directory.</p>

<p>The tables in the ArchivesSpace database can be grouped into several general categories:</p>
<ul>
  <li><a href="#Main-record-tables">Main record tables</a></li>
  <li><a href="#Supporting-record-tables">Supporting record tables</a></li>
  <li><a href="#Subrecord-tables">Subrecord tables</a></li>
  <li><a href="#Relationship-tables">Relationship/linking tables</a></li>
  <li><a href="#Enumerations">Enumeration tables</a></li>
  <li><a href="#User-setting-and-permission-tables">User, setting, and permission tables</a></li>
  <li><a href="#Job-tables">Job tables</a></li>
  <li><a href="#System-tables">System tables</a></li>
</ul>

<p>One way to get a view of all tables and columns in your ArchivesSpace instance is to run the following query in a MySQL client:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  SELECT TABLE_SCHEMA
  	, TABLE_NAME
  	, COLUMN_NAME
  	, ORDINAL_POSITION
  	, IS_NULLABLE
  	, COLUMN_TYPE
  	, COLUMN_KEY
  FROM INFORMATION_SCHEMA.COLUMNS
  #change the following value to whatever your database is named
  WHERE TABLE_SCHEMA Like 'archivesspace'
</code></pre></div></div>

<p>Additionally, a BETA version of an <a href="https://github.com/archivesspace/data-dictionary-initial">ArchivesSpace data dictionary</a> has been created by members of the ArchivesSpace development team and the ArchivesSpace User Advisory Council Reports team.</p>

<h2 id="main-record-tables">Main record tables</h2>

<p>These tables hold data about the primary record types in ArchivesSpace. Main record types are distinguished from subrecords in that they have their own persistent URIs - corresponding to their database identifiers/primary keys - that are resolvable via the staff interface, public interface, and API. They are distinguished from supporting records in that they are the primary descriptive record types that users will interact with in the system.</p>

<p>All of these records, except archival objects, can be created independently of any other record. Archival object records represent components of a larger entity, and so they must have a resource record as a root parent. See the <a href="#Parent-Child-Relationships-and-Sequencing">parent/child relationships</a> section for more information about the representation of  hierarchical relationships in the database.</p>

<p>A few common fields occur in several main record tables. These similar fields are defined by the parent schemas in the <code class="language-plaintext highlighter-rouge">common/schemas</code> directory:</p>

<table>
  <thead>
    <tr>
      <th>Column Name</th>
      <th>Tables</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">title</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">identifier</code>/<code class="language-plaintext highlighter-rouge">component_id</code>/<code class="language-plaintext highlighter-rouge">digital_object_id</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">resource</code>/<code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>/<code class="language-plaintext highlighter-rouge">digital_object</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">other_level</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository_processing_note</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
  </tbody>
</table>

<!-- Booleans -->

<p>All of the main records have a set of fields which store boolean values (<code class="language-plaintext highlighter-rouge">0</code> or <code class="language-plaintext highlighter-rouge">1</code>) that indicate whether the records are published in the public user interface, suppressed in the staff interface, or have some kind of applicable restriction. The exception to this is the <code class="language-plaintext highlighter-rouge">repository</code> table, which does not have a restriction boolean, but does have a <code class="language-plaintext highlighter-rouge">hidden</code> boolean. The <code class="language-plaintext highlighter-rouge">accession</code> table has multiple restriction-related booleans. See the section below for more information about boolean fields.</p>

<p>Beginning in version 2.6.0, the main record tables (and some supporting records - see below) also contain fields which hold data about archival resource keys (ARKs) and human-readable URLs (slugs):</p>

<table>
  <thead>
    <tr>
      <th>Column Name</th>
      <th>Tables</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">slug</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">repository</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">external_ark_url</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
  </tbody>
</table>

<p>Also stored in these and all other tables are enumeration values, foreign keys which correspond to database identifiers in the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table, which stores controlled values. See enumeration section below for more detail.</p>

<p>All subrecord data types - i.e. dates, extents, instances - relating to a main or supporting record are stored in their own tables and linked to main or supporting records via foreign key references in the subrecord tables. See subrecord section below for more detail.</p>

<p>The remaining data in the main record tables is text, and is unique to each table:</p>

<table>
  <thead>
    <tr>
      <th>TABLE_NAME</th>
      <th>COLUMN_NAME</th>
      <th>IS_NULLABLE</th>
      <th>COLUMN_TYPE</th>
      <th>COLUMN_KEY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">content_description</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">condition_description</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">disposition</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">inventory</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">provenance</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">general_note</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_date</code></td>
      <td>YES</td>
      <td>date</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">retention_rule</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">access_restrictions_note</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">use_restrictions_note</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code></td>
      <td><code class="language-plaintext highlighter-rouge">ref_id</code></td>
      <td>NO</td>
      <td>varchar(255)</td>
      <td>MUL</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">digital_object_component</code></td>
      <td><code class="language-plaintext highlighter-rouge">label</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">repo_code</code></td>
      <td>NO</td>
      <td>varchar(255)</td>
      <td>UNI</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">name</code></td>
      <td>NO</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">org_code</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">parent_institution_name</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">url</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">image_url</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">contact_persons</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">description</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">oai_is_disabled</code></td>
      <td>YES</td>
      <td>int</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">oai_sets_available</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">ead_id</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">ead_location</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_title</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_filing_title</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_date</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_author</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_language_note</code></td>
      <td>YES</td>
      <td>varchar(255)</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_sponsor</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_edition_statement</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_series_statement</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_note</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_subtitle</code></td>
      <td>YES</td>
      <td>text</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<!-- arguably top contsainers should be here, or digital objects should be in the supporting records -->

<h2 id="supporting-record-tables">Supporting record tables</h2>

<p>Like the main record types listed above, supporting records can also be created independently of other records, and are addressable in the staff interface and API via their own URI. However, they are primarily meaningful via their many-to-many linkages to the main record types (and, sometimes, other supporting record types). These records typically provide additional information about, or otherwise enhance, the primary record types. A few supporting record types - for instance those in the <code class="language-plaintext highlighter-rouge">term</code> table - are used to enhance other supporting record types.</p>

<table>
  <thead>
    <tr>
      <th>Supporting module tables</th>
      <th>Linked to</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">agent_corporate_entity</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">agent_family</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">agent_person</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">agent_software</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">assessment</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">classification</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">classification_term</code></td>
      <td><code class="language-plaintext highlighter-rouge">classification</code>, <code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">container_profile</code></td>
      <td><code class="language-plaintext highlighter-rouge">top_container</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">event</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location_profile</code></td>
      <td><code class="language-plaintext highlighter-rouge">location</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">subject</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">archival_object</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">term</code></td>
      <td><code class="language-plaintext highlighter-rouge">subject</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">top_container</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">vocabulary</code></td>
      <td><code class="language-plaintext highlighter-rouge">subject</code>, <code class="language-plaintext highlighter-rouge">term</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">assessment_attribute_definition</code></td>
      <td><code class="language-plaintext highlighter-rouge">assessment_attribute</code>, <code class="language-plaintext highlighter-rouge">assessment_attribute_note</code></td>
    </tr>
  </tbody>
</table>

<!-- is this the appropriate place for the assessment attribute def? Vocabulary? -->

<h2 id="subrecord-tables">Subrecord tables</h2>

<!-- link to ### Nested records section of the backend readme -->

<p>Subrecords must be associated with a main or supporting record - they cannot be created independently. As such, they do not have their own URIs, and can only be accessed via the API by retrieving the top-level record with which they are associated. In the staff interface these records are embedded within main or supporting record views. In the API subrecord data is contained in arrays within main or supporting records.</p>

<p>The various subrecord types do have their own database tables. In addition to data specific to the subrecord type, the tables also contain foreign key columns which hold the database identifiers of main or supporting records. Subrecord tables must have a value in one of the foreign key fields. Some subrecords can have another subrecord as parent (for instance, the <code class="language-plaintext highlighter-rouge">sub_container</code> subrecord has <code class="language-plaintext highlighter-rouge">instance_id</code> as its foreign key column).</p>

<p>Subrecords exist in a one-to-many relationship with their parent records, so a record’s <code class="language-plaintext highlighter-rouge">id</code> may appear multiple times in a subrecord table (i.e. when there are two dates associated with a resource record).</p>

<p>It is important to note that subrecords are deleted and recreated upon each save of the main or supporting record with which they are associated, regardless of whether the subrecord itself is modified. This means that the database identifier is deleted and reassigned upon each save.</p>

<table>
  <thead>
    <tr>
      <th>Subrecord tables</th>
      <th>Foreign keys</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">agent_contact</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_person_id</code>, <code class="language-plaintext highlighter-rouge">agent_family_id</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity_id</code>, <code class="language-plaintext highlighter-rouge">agent_software_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">date</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">deaccession_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">event_id</code>,             <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code>, <code class="language-plaintext highlighter-rouge">related_agents_rlshp_id</code>, <code class="language-plaintext highlighter-rouge">agent_person_id</code>, <code class="language-plaintext highlighter-rouge">agent_family_id</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity_id</code>, <code class="language-plaintext highlighter-rouge">agent_software_id</code>, <code class="language-plaintext highlighter-rouge">name_person_id</code>, <code class="language-plaintext highlighter-rouge">name_family_id</code>, <code class="language-plaintext highlighter-rouge">name_corporate_entity_id</code>, <code class="language-plaintext highlighter-rouge">name_software_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">extent</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">deaccession_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">external_document</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">subject_id</code>, <code class="language-plaintext highlighter-rouge">agent_person_id</code>, <code class="language-plaintext highlighter-rouge">agent_family_id</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity_id</code>, <code class="language-plaintext highlighter-rouge">agent_software_id</code>, <code class="language-plaintext highlighter-rouge">rights_statement_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code>, <code class="language-plaintext highlighter-rouge">event_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">external_id</code></td>
      <td><code class="language-plaintext highlighter-rouge">subject_id</code>, <code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">collection_management_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code>, <code class="language-plaintext highlighter-rouge">event_id</code>, <code class="language-plaintext highlighter-rouge">location_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">file_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">instance</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">accession_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_authority_id</code></td>
      <td><code class="language-plaintext highlighter-rouge">name_person_id</code>, <code class="language-plaintext highlighter-rouge">name_family_id</code>, <code class="language-plaintext highlighter-rouge">name_software_id</code>, <code class="language-plaintext highlighter-rouge">name_corporate_entity_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_corporate_entity</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_corporate_entity_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_family</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_family_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_person</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_person_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_software</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_software_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">note</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code>, <code class="language-plaintext highlighter-rouge">agent_person_id</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity_id</code>, <code class="language-plaintext highlighter-rouge">agent_family_id</code>, <code class="language-plaintext highlighter-rouge">agent_software_id</code>, <code class="language-plaintext highlighter-rouge">rights_statement_act_id</code>, <code class="language-plaintext highlighter-rouge">rights_statement_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">note_persistent_id</code></td>
      <td><code class="language-plaintext highlighter-rouge">note_id</code>, <code class="language-plaintext highlighter-rouge">parent_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">revision_statement</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_restriction</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_restriction_type</code></td>
      <td><code class="language-plaintext highlighter-rouge">rights_restriction_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code>, <code class="language-plaintext highlighter-rouge">repo_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_act</code></td>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sub_container</code></td>
      <td><code class="language-plaintext highlighter-rouge">instance_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">telephone</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_contact_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">user_defined</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">ark_name</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">assessment_attribute_note</code></td>
      <td><code class="language-plaintext highlighter-rouge">assessment_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">assessment_attribute</code></td>
      <td><code class="language-plaintext highlighter-rouge">assessment_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lang_material</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_component_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">language_and_script</code></td>
      <td><code class="language-plaintext highlighter-rouge">lang_material_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">collection_management</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession_id</code>, <code class="language-plaintext highlighter-rouge">resource_id</code>, <code class="language-plaintext highlighter-rouge">digital_object_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location_function</code></td>
      <td><code class="language-plaintext highlighter-rouge">location_id</code></td>
    </tr>
  </tbody>
</table>

<!-- appropriate place for collection management and deaccession stuff? what about location function? all the rights statement stuff? Is there a specific thing that defines a subrecord as a subrecord? -->

<h2 id="relationship-tables">Relationship tables</h2>

<p>These tables exist to enable linking between main records and supporting records. Relationship tables are necessary because, unlike subrecord tables, supporting record tables do not include foreign keys which link them to the main record tables.</p>

<p>Most relationship tables have the <code class="language-plaintext highlighter-rouge">_rlshp</code> suffix in their names. They typically contain just the primary keys for the tables that are being linked, though a few tables also include fields that are specific to the relationship between the two record types.</p>

<table>
  <thead>
    <tr>
      <th>Relationship/linking tables</th>
      <th>Tables linked</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">assessment_reviewer_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">assessment</code> to <code class="language-plaintext highlighter-rouge">agent_person</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">assessment_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">assessment</code> to <code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">resource</code>, or <code class="language-plaintext highlighter-rouge">digital_object</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">classification_creator_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">classification</code> to <code class="language-plaintext highlighter-rouge">agent_person</code>, <code class="language-plaintext highlighter-rouge">agent_family</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity</code>, or <code class="language-plaintext highlighter-rouge">agent_software</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">classification_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">classification</code> or <code class="language-plaintext highlighter-rouge">classification_term</code> to <code class="language-plaintext highlighter-rouge">resource</code> or <code class="language-plaintext highlighter-rouge">accession</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">classification_term_creator_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">classification_term</code> to <code class="language-plaintext highlighter-rouge">agent_person</code>, <code class="language-plaintext highlighter-rouge">agent_family</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity</code>, or <code class="language-plaintext highlighter-rouge">agent_software</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">event_link_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">event</code> to <code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">agent_person</code>, <code class="language-plaintext highlighter-rouge">agent_family</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity</code>, <code class="language-plaintext highlighter-rouge">agent_software</code>, or <code class="language-plaintext highlighter-rouge">top_container</code>. Also includes the <code class="language-plaintext highlighter-rouge">role_id</code> table, which can be joined with the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table to return the event role (source, outcome, transfer, context)</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">instance_do_link_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">digital_object</code> to <code class="language-plaintext highlighter-rouge">instance</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">linked_agents_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_person</code>, <code class="language-plaintext highlighter-rouge">agent_software</code>, <code class="language-plaintext highlighter-rouge">agent_family</code>, or <code class="language-plaintext highlighter-rouge">agent_corporate_entity</code> to <code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">event</code>, or <code class="language-plaintext highlighter-rouge">resource</code>. Also includes the <code class="language-plaintext highlighter-rouge">role_id</code> and <code class="language-plaintext highlighter-rouge">relator_id</code> tables, which can be joined with the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location_profile_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">location</code> to <code class="language-plaintext highlighter-rouge">location_profile</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">owner_repo_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">location</code> to <code class="language-plaintext highlighter-rouge">repository</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">related_accession_rlshp</code></td>
      <td>Links a row in the <code class="language-plaintext highlighter-rouge">accession</code> table to another row in the <code class="language-plaintext highlighter-rouge">accession</code> table. Also includes fields for <code class="language-plaintext highlighter-rouge">relator</code> and relationship type.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">related_agents_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">agent_person</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity</code>, <code class="language-plaintext highlighter-rouge">agent_software</code>, or <code class="language-plaintext highlighter-rouge">agent_family</code> to other agent tables, or two rows in the same agent table. Also includes fields for <code class="language-plaintext highlighter-rouge">relator</code> and <code class="language-plaintext highlighter-rouge">description</code>, and the type of relationship.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">spawned_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession</code> to <code class="language-plaintext highlighter-rouge">resource</code>. This contains all linked accession data, even if the resource was not spawned from the accession record.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">subject_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">subject</code> to <code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, or <code class="language-plaintext highlighter-rouge">digital_object_component</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">surveyed_by_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">assessment</code> to <code class="language-plaintext highlighter-rouge">agent_person</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">top_container_housed_at_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">top_container</code> to <code class="language-plaintext highlighter-rouge">location</code>. Also includes fields for <code class="language-plaintext highlighter-rouge">start_date</code>, <code class="language-plaintext highlighter-rouge">end_date</code>, <code class="language-plaintext highlighter-rouge">status</code>, and a free-text <code class="language-plaintext highlighter-rouge">note</code>.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">top_container_link_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">top_container</code> to <code class="language-plaintext highlighter-rouge">sub_container</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">top_container_profile_rlshp</code></td>
      <td><code class="language-plaintext highlighter-rouge">top_container</code> to <code class="language-plaintext highlighter-rouge">container_profile</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">subject_term</code></td>
      <td><code class="language-plaintext highlighter-rouge">subject</code> to <code class="language-plaintext highlighter-rouge">term</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">linked_agent_term</code></td>
      <td><code class="language-plaintext highlighter-rouge">linked_agents_rlshp</code> to <code class="language-plaintext highlighter-rouge">term</code></td>
    </tr>
  </tbody>
</table>

<!-- is the assessment definition thing a linking table - it pretty much only has foreign keys

Same question about one of the rights restriction tables - can't remember which one right now.
 -->

<p>It is not always obvious which relationship tables will provide the desired results. For instance, to get a box list for a given resource record, enter the following query into a MySQL editor:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT DISTINCT 	CONCAT('/repositories/', resource.repo_id, '/resources/', resource.id) as resource_uri
 	, resource.identifier
 	, resource.title
 	, tc.barcode as barcode
 	, tc.indicator as box_number
 FROM sub_container sc
 JOIN top_container_link_rlshp tclr on tclr.sub_container_id = sc.id
 JOIN top_container tc on tclr.top_container_id = tc.id
 JOIN instance on sc.instance_id = instance.id
 JOIN archival_object ao on instance.archival_object_id = ao.id
 JOIN resource on ao.root_record_id = resource.id
 #change to your desired resource id
 WHERE resource.id = 4556
</code></pre></div></div>

<p>Sometimes numerous relationship tables must be joined to retrieve the desired results. For instance, to get all boxes and folders for a given resource record, including any container profiles and locations, enter the following query into a MySQL editor:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> SELECT CONCAT('/repositories/', tc.repo_id, '/top_containers/', tc.id) as tc_uri
 	, CONCAT('/repositories/', resource.repo_id, '/resources/', resource.id) as resource_uri
 	, CONCAT('/repositories/', resource.repo_id) as repo_uri
 	, CONCAT('/repositories/', ao.repo_id, '/archival_objects/', ao.id) as ao_uri
 	, resource.identifier AS resource_identifier
 	, resource.title AS resource_title
   , ao.display_string AS ao_title
   , ev2.value AS level
   , tc.barcode AS barcode
 	, cp.name AS container_profile
 	, tc.indicator AS container_num
   , ev.value AS sc_type
   , sc.indicator_2 AS sc_num
 from sub_container sc
 JOIN top_container_link_rlshp tclr on tclr.sub_container_id = sc.id
 JOIN top_container tc on tclr.top_container_id = tc.id
 LEFT JOIN top_container_profile_rlshp tcpr on tcpr.top_container_id = tc.id
 LEFT JOIN container_profile cp on cp.id = tcpr.container_profile_id
 LEFT JOIN top_container_housed_at_rlshp tchar on tchar.top_container_id = tc.id
 JOIN instance on sc.instance_id = instance.id
 JOIN archival_object ao on instance.archival_object_id = ao.id
 JOIN resource on ao.root_record_id = resource.id
 LEFT JOIN enumeration_value ev on ev.id = sc.type_2_id
 LEFT JOIN enumeration_value ev2 on ev2.id = ao.level_id
 #change to your desired resource id
 WHERE resource.id = 4223

</code></pre></div></div>
<p><!-- Mention the CONCAT function for creating URIs --></p>

<h2 id="enumerations">Enumerations</h2>

<p>All controlled values used by the application - excluding tool-tips and frontend/public display values and the values that are stored a few of the supporting record tables (see below) - are stored in a table called <code class="language-plaintext highlighter-rouge">enumeration_values</code>. Controlled values are organized into a variety of parent enumerations (akin to a set of distinct controlled value lists) which are utilized by different record and subrecord types. Parent enumeration data is stored in the <code class="language-plaintext highlighter-rouge">enumeration</code> table and is linked by foreign key in the <code class="language-plaintext highlighter-rouge">enumeration_id</code> field in the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table. In the record and subrecord tables, enumeration values appear as foreign keys in a variety of foreign key columns, usually identified by an <code class="language-plaintext highlighter-rouge">_id</code> suffix.</p>

<p>ArchivesSpace comes with a standard set of controlled values, but most of these are modifiable by end-users via the staff interface and API. However, some values in the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table are read-only - these values define the terminology and data types used in different parts of the application (i.e. the various note types).</p>

<p>Enumeration IDs appear as foreign keys in a variety of database tables:</p>

<table>
  <thead>
    <tr>
      <th>table_name</th>
      <th>column_name</th>
      <th>enumeration_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">acquisition_type_id</code></td>
      <td>accession_acquisition_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">accession</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource_type_id</code></td>
      <td>accession_resource_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">agent_contact</code></td>
      <td><code class="language-plaintext highlighter-rouge">salutation_id</code></td>
      <td>agent_contact_salutation</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code></td>
      <td><code class="language-plaintext highlighter-rouge">level_id</code></td>
      <td>archival_record_level</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">collection_management</code></td>
      <td><code class="language-plaintext highlighter-rouge">processing_priority_id</code></td>
      <td>collection_management_processing_priority</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">collection_management</code></td>
      <td><code class="language-plaintext highlighter-rouge">processing_status_id</code></td>
      <td>collection_management_processing_status</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">collection_management</code></td>
      <td><code class="language-plaintext highlighter-rouge">processing_total_extent_type_id</code></td>
      <td>extent_extent_type_id</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">container_profile</code></td>
      <td><code class="language-plaintext highlighter-rouge">dimension_units_id</code></td>
      <td>dimension_units</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">date</code></td>
      <td><code class="language-plaintext highlighter-rouge">calendar_id</code></td>
      <td>date_calendar</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">date</code></td>
      <td><code class="language-plaintext highlighter-rouge">certainty_id</code></td>
      <td>date_certainty</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">date</code></td>
      <td><code class="language-plaintext highlighter-rouge">date_type_id</code></td>
      <td>date_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">date</code></td>
      <td><code class="language-plaintext highlighter-rouge">era_id</code></td>
      <td>date_era</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">date</code></td>
      <td><code class="language-plaintext highlighter-rouge">label_id</code></td>
      <td>date_label</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">deaccession</code></td>
      <td><code class="language-plaintext highlighter-rouge">scope_id</code></td>
      <td>deaccession_scope</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">digital_object</code></td>
      <td><code class="language-plaintext highlighter-rouge">digital_oject_type_id</code></td>
      <td>digital_object_digital_object_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">digital_object</code></td>
      <td><code class="language-plaintext highlighter-rouge">level_id</code></td>
      <td>digital_object_level</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">event</code></td>
      <td><code class="language-plaintext highlighter-rouge">event_type_id</code></td>
      <td>event_event_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">event</code></td>
      <td><code class="language-plaintext highlighter-rouge">outcome_id</code></td>
      <td>event_outcome</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">extent</code></td>
      <td><code class="language-plaintext highlighter-rouge">extent_type_id</code></td>
      <td>extent_extent_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">extent</code></td>
      <td><code class="language-plaintext highlighter-rouge">portion_id</code></td>
      <td>extent_portion</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">external_document</code></td>
      <td><code class="language-plaintext highlighter-rouge">identifier_type_id</code></td>
      <td>rights_statement_external_document_identifier_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">file_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">checksum_method_id</code></td>
      <td>file_version_checksum_methods</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">file_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">file_format_name_id</code></td>
      <td>file_version_file_format_name</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">file_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">use_statement_id</code></td>
      <td>file_version_use_statement</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">file_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">xlink_actuate_attribute_id</code></td>
      <td>file_version_xlink_actuate_attribute</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">file_version</code></td>
      <td><code class="language-plaintext highlighter-rouge">xlink_show_attribute_id</code></td>
      <td>file_version_xlink_show_attribute</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">instance</code></td>
      <td><code class="language-plaintext highlighter-rouge">instance_type_id</code></td>
      <td>instance_instance_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">language_and_script</code></td>
      <td><code class="language-plaintext highlighter-rouge">language_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">language_and_script</code></td>
      <td><code class="language-plaintext highlighter-rouge">script_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location</code></td>
      <td><code class="language-plaintext highlighter-rouge">temporary_id</code></td>
      <td>location_temporary</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location_function</code></td>
      <td><code class="language-plaintext highlighter-rouge">location_function_type_id</code></td>
      <td>location_function_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">location_profile</code></td>
      <td><code class="language-plaintext highlighter-rouge">dimension_units_id</code></td>
      <td>dimension_units</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_corporate_entity</code></td>
      <td><code class="language-plaintext highlighter-rouge">rules_id</code></td>
      <td>name_rule</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_corporate_entity</code></td>
      <td><code class="language-plaintext highlighter-rouge">source_id</code></td>
      <td>name_source</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_family</code></td>
      <td><code class="language-plaintext highlighter-rouge">rules_id</code></td>
      <td>name_rule</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_family</code></td>
      <td><code class="language-plaintext highlighter-rouge">source_id</code></td>
      <td>name_source</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_person</code></td>
      <td><code class="language-plaintext highlighter-rouge">name_order_id</code></td>
      <td>name_person_name_order</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_person</code></td>
      <td><code class="language-plaintext highlighter-rouge">rules_id</code></td>
      <td>name_rule</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_person</code></td>
      <td><code class="language-plaintext highlighter-rouge">source_id</code></td>
      <td>name_source</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_software</code></td>
      <td><code class="language-plaintext highlighter-rouge">rules_id</code></td>
      <td>name_rule</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">name_software</code></td>
      <td><code class="language-plaintext highlighter-rouge">source_id</code></td>
      <td>name_source</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repository</code></td>
      <td><code class="language-plaintext highlighter-rouge">country_id</code></td>
      <td>country_iso_3166</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_description_rules_id</code></td>
      <td>resource_finding_aid_description_rules</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_language_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_script_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">finding_aid_status_id</code></td>
      <td>resource_finding_aid_status</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">level_id</code></td>
      <td>archival_record_level</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">resource</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource_type_id</code></td>
      <td>resource_resource_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_restriction_type</code></td>
      <td><code class="language-plaintext highlighter-rouge">restriction_type_id</code></td>
      <td>restriction_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement</code></td>
      <td><code class="language-plaintext highlighter-rouge">jurisdiction_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement</code></td>
      <td><code class="language-plaintext highlighter-rouge">other_rights_basis_id</code></td>
      <td>rights_statement_other_rights_basis</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement</code></td>
      <td><code class="language-plaintext highlighter-rouge">rights_type_id</code></td>
      <td>rights_statement_rights_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement</code></td>
      <td><code class="language-plaintext highlighter-rouge">status_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_act</code></td>
      <td><code class="language-plaintext highlighter-rouge">act_type_id</code></td>
      <td>rights_statement_act_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_act</code></td>
      <td><code class="language-plaintext highlighter-rouge">restriction_id</code></td>
      <td>rights_statement_act_restriction</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_pre_088</code></td>
      <td><code class="language-plaintext highlighter-rouge">ip_status_id</code></td>
      <td>rights_statement_ip_status</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_pre_088</code></td>
      <td><code class="language-plaintext highlighter-rouge">jurisdiction_id</code></td>
      <td> </td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rights_statement_pre_088</code></td>
      <td><code class="language-plaintext highlighter-rouge">rights_type_id</code></td>
      <td>rights_statement_rights_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sub_container</code></td>
      <td><code class="language-plaintext highlighter-rouge">type_2_id</code></td>
      <td>container_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sub_container</code></td>
      <td><code class="language-plaintext highlighter-rouge">type_3_id</code></td>
      <td>container_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">subject</code></td>
      <td><code class="language-plaintext highlighter-rouge">source_id</code></td>
      <td>subject_source</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">telephone</code></td>
      <td><code class="language-plaintext highlighter-rouge">number_type_id</code></td>
      <td>telephone_number_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">term</code></td>
      <td><code class="language-plaintext highlighter-rouge">term_type_id</code></td>
      <td>subject_term_type</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">top_container</code></td>
      <td><code class="language-plaintext highlighter-rouge">type_id</code></td>
      <td>container_type</td>
    </tr>
  </tbody>
</table>

<!-- need to add some rlshp tables which have enums -->

<p>To translate the enumeration ID that appears in the record and subrecord tables, join the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table. The table can be joined multiple times if there are multiple values to translate, but you must use an alias for each table. For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT CONCAT('/repositories/', ao.repo_id, '/archival_objects/', ao.id) as ao_uri
  , ao.display_string as ao_title
  , date.begin
  , date.end
  , ev.value as date_label
  , ev2.value as date_type
  , ev3.value as date_calendar
FROM archival_object ao
LEFT JOIN date on date.archival_object_id = ao.id
LEFT JOIN enumeration_value ev on ev.id = date.label_id
LEFT JOIN enumeration_value ev2 on ev2.id = date.date_type_id
LEFT JOIN enumeration_value ev3 on ev3.id = date.calendar_id
</code></pre></div></div>

<p><strong>NOTE</strong>: <code class="language-plaintext highlighter-rouge">container_profile</code>, <code class="language-plaintext highlighter-rouge">location_profile</code>, and <code class="language-plaintext highlighter-rouge">assessment_attribute_definition</code> records are similar to the records in the <code class="language-plaintext highlighter-rouge">enumeration_value</code> table in that they store controlled values which are referenced by other parts of the system. However, they differ in that they have their own tables and are addressable via their own URIs.</p>

<h2 id="user-setting-and-permission-tables">User, setting, and permission tables</h2>

<p>These tables store user and permissions information, user/repository/global preferences, and RDE and custom report templates.</p>

<table>
  <thead>
    <tr>
      <th>Table name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">custom_report_template</code></td>
      <td>Custom report templates</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">default_values</code></td>
      <td>Default values settings</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">group</code></td>
      <td>Data about permission groups created by each repository</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">group_permission</code></td>
      <td>Links the permission table to the group table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">group_user</code></td>
      <td>Links the group table to the user table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">oai_config</code></td>
      <td>Configuration data for OAI-PMH harvesting</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">permission</code></td>
      <td>All permission types that can be assigned to users</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">preference</code></td>
      <td>User preference data</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">rde_template</code></td>
      <td>RDE templates</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">required_fields</code></td>
      <td>Contains repository-defined required fields</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">user</code></td>
      <td>User data</td>
    </tr>
  </tbody>
</table>

<h2 id="job-tables">Job tables</h2>

<p>These tables store data related to background jobs, including imports.</p>

<table>
  <thead>
    <tr>
      <th>Table name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">job</code></td>
      <td>All jobs which have been run in an ArchivesSpace instance.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">job_created_record</code></td>
      <td>Records created via background jobs</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">job_input_file</code></td>
      <td>Data about input files used in background jobs</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">job_modified_record</code></td>
      <td>Data about records modified via background jobs</td>
    </tr>
  </tbody>
</table>

<h2 id="system-tables">System tables</h2>

<p>These tables track actions taken against the database (i.e. edits and deletes), system events, session and authorization data, and database information. These tables are typically not referenced by any other table.</p>

<table>
  <thead>
    <tr>
      <th>Table name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">active_edit</code></td>
      <td>Records being actively edited by a user. Read-only system table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">auth_db</code></td>
      <td>Authentication data for users. Read-only system table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">deleted_records</code></td>
      <td>Records deleted in the past 24 hours. Read-only system table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">notification</code></td>
      <td>Notifications stream. Read-only system table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">schema_info</code></td>
      <td>Contains the database schema version. Read-only system table.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">sequence</code></td>
      <td>The value corresponds to the number of children the archival object has - 1. Read-only system table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">session</code></td>
      <td>Recent session data. Read-only system table</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">system_event</code></td>
      <td>System event data. Read-only system table</td>
    </tr>
  </tbody>
</table>

<!--  these are subrecords -->
<!-- | subnote_metadata |
| rights_statement_pre_088  | -->

<h2 id="parent-child-relationships-and-sequencing">Parent-Child Relationships and Sequencing</h2>

<h3 id="repository-scoped-records">Repository-scoped records</h3>

<p>Many main and supporting records are scoped to a particular repository. In these tables the parent repository is identified by a foreign key which corresponds to the database identifier in the <code class="language-plaintext highlighter-rouge">repository</code> table:</p>

<table>
  <thead>
    <tr>
      <th>Column name</th>
      <th>Description</th>
      <th>Example</th>
      <th>Found in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">repo_id</code></td>
      <td>The database ID of the parent repository</td>
      <td><code class="language-plaintext highlighter-rouge">12</code></td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">assessment</code>, <code class="language-plaintext highlighter-rouge">assessment_attribute_definition</code>, <code class="language-plaintext highlighter-rouge">classification</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">custom_report_template</code>, <code class="language-plaintext highlighter-rouge">default_values</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">event</code>, <code class="language-plaintext highlighter-rouge">group</code>, <code class="language-plaintext highlighter-rouge">job</code>, <code class="language-plaintext highlighter-rouge">preference</code>, <code class="language-plaintext highlighter-rouge">required_fields</code>, <code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">rights_statement</code>, <code class="language-plaintext highlighter-rouge">top_container</code></td>
    </tr>
  </tbody>
</table>

<h3 id="parentchild-relationships">Parent/child relationships</h3>

<p>Hierarchical relationships between other records are also expressed through foreign keys:</p>

<table>
  <thead>
    <tr>
      <th>Column name</th>
      <th>Description</th>
      <th>Example</th>
      <th>PK Tables</th>
      <th>Found in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">root_record_id</code></td>
      <td>The database ID of the root parent record</td>
      <td><code class="language-plaintext highlighter-rouge">4566</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">classification</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">classification_term</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">parent_id</code></td>
      <td>The database ID of the immediate parent record. This is used to identify parent records which are of the same type as the child record (i.e. two archival object records). The value will be NULL if the only parent is the root record.</td>
      <td><code class="language-plaintext highlighter-rouge">1748121</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">note_persistent_id</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">parent_name</code></td>
      <td>The database ID or URI, and the record type of the immediate parent</td>
      <td><code class="language-plaintext highlighter-rouge">144@archival_object</code>, <code class="language-plaintext highlighter-rouge">root@/repositories/2/resources/2</code></td>
      <td><code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">classification</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code></td>
      <td><code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code></td>
    </tr>
  </tbody>
</table>

<p>Beginning with MySQL 8, you can recursively retrieve all parents of an archival object (or all archival objects linked to a resource) by running the following query:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>WITH RECURSIVE ao_path AS
  (SELECT ao1.id
    , ao1.display_string
    , ao1.component_id
    , ao1.parent_id
    , ev.value as `ao_level`
    , 1 as level
   FROM archival_object ao1
   LEFT JOIN enumeration_value ev on ev.id = ao1.level_id
   WHERE ao1.id = &lt;your ao id&gt;
   &lt;!-- to get all trees for a resource change to: WHERE ao1.root_record_id = &lt;your root_record_id&gt; --&gt;
   UNION ALL
   SELECT ao2.id
    , ao2.display_string
    , ao2.component_id
    , ao2.parent_id
    , ev.value as `ao_level`
    , ao_path.level + 1 as level
   FROM ao_path
   JOIN archival_object ao2 on ao_path.parent_id = ao2.id
   LEFT JOIN enumeration_value ev on ev.id = ao2.level_id)
   SELECT GROUP_CONCAT(CONCAT(display_string, ' ', ' (', CONCAT(UPPER(SUBSTRING(ao_level,1,1)),LOWER(SUBSTRING(ao_level,2))), ' ', IF(component_id is not NULL, CAST(component_id as CHAR), "N/A"), ')') ORDER BY level DESC SEPARATOR ' &gt; ') as tree
   FROM ao_path;

</code></pre></div></div>

<p>To retrieve all children (MySQL 8+):</p>

<p>To retrieve both parents and children (MySQL 8+):</p>

<p>To retrieve all parents of a record in MySQL 5.7 and below, run the following query:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT (SELECT GROUP_CONCAT(CONCAT(display_string, ' (', ao_level, ')') SEPARATOR ' &lt; ') as parent_path
		FROM (SELECT T2.display_string as display_string
					, ev.value as ao_level
			  FROM (SELECT @r AS _id
						, @p := @r AS previous
						, (SELECT @r := parent_id FROM archival_object WHERE id = _id) AS parent_id
						, @l := @l + 1 AS lvl
      				FROM ((SELECT @r := 1749840, @p := 0, @l := 0) AS vars,
           					archival_object h)
      					   WHERE @r &lt;&gt; 0 AND @r &lt;&gt; @p) AS T1
			  JOIN archival_object T2 ON T1._id = T2.id
			  LEFT JOIN enumeration_value ev on ev.id = T2.level_id
			  WHERE T2.id != 1749840
			  ORDER BY T1.lvl DESC) as all_parents) as p_path
	 , ao.display_string
	 , CONCAT('/repositories/', ao.repo_id, '/archival_objects/', ao.id) as uri
FROM archival_object ao
WHERE ao.id = 1749840
</code></pre></div></div>

<p>To retrieve all children of a record (MysQL 5.7 and below):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code></code></pre></div></div>

<h3 id="sequencing">Sequencing</h3>

<p>The ordering of records in a <code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">classification</code>, or <code class="language-plaintext highlighter-rouge">digital_object</code> tree is determined by the <code class="language-plaintext highlighter-rouge">position</code> field. The position field is also used to order values in the <code class="language-plaintext highlighter-rouge">enumeration_value</code> and <code class="language-plaintext highlighter-rouge">assessment_attribute_definition</code> tables:</p>

<table>
  <thead>
    <tr>
      <th>Column name</th>
      <th>Description</th>
      <th>Example</th>
      <th>Found in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">position</code></td>
      <td>The position of the archival object under the immediate parent</td>
      <td><code class="language-plaintext highlighter-rouge">168000</code></td>
      <td><code class="language-plaintext highlighter-rouge">enumeration_value</code>, <code class="language-plaintext highlighter-rouge">assessment_attribute_definition</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">archival_object</code></td>
    </tr>
  </tbody>
</table>

<h2 id="boolean-fields">Boolean fields</h2>

<p>Many records and subrecords include fields which contain integers (<code class="language-plaintext highlighter-rouge">0</code> or <code class="language-plaintext highlighter-rouge">1</code>) corresponding to boolean values.</p>

<table>
  <thead>
    <tr>
      <th>Boolean fields</th>
      <th>Description</th>
      <th>Found in</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">publish</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">subnote_metadata</code>, <code class="language-plaintext highlighter-rouge">file_version</code>, <code class="language-plaintext highlighter-rouge">external_document</code>, <code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">classification</code>, <code class="language-plaintext highlighter-rouge">agent_person</code>, <code class="language-plaintext highlighter-rouge">agent_family</code>, <code class="language-plaintext highlighter-rouge">agent_software</code>, <code class="language-plaintext highlighter-rouge">agent_corporate_entity</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">revision_statement</code>, <code class="language-plaintext highlighter-rouge">repository</code>, <code class="language-plaintext highlighter-rouge">note</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">resource</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">suppressed</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code>, <code class="language-plaintext highlighter-rouge">assessment_reviewer_rlshp</code>, <code class="language-plaintext highlighter-rouge">assessment_rlshp</code>, <code class="language-plaintext highlighter-rouge">classification</code>, <code class="language-plaintext highlighter-rouge">classification_creator_rlshp</code>, <code class="language-plaintext highlighter-rouge">classification_rlshp</code>, <code class="language-plaintext highlighter-rouge">classification_term</code>, <code class="language-plaintext highlighter-rouge">classification_term_creator_rlshp</code>, <code class="language-plaintext highlighter-rouge">digital_object</code>, <code class="language-plaintext highlighter-rouge">digital_object_component</code>, <code class="language-plaintext highlighter-rouge">enumeration_value</code>, <code class="language-plaintext highlighter-rouge">event</code>, <code class="language-plaintext highlighter-rouge">event_link_rlshp</code>, <code class="language-plaintext highlighter-rouge">instance_do_link_rlshp</code>, <code class="language-plaintext highlighter-rouge">linked_agents_rlshp</code>, <code class="language-plaintext highlighter-rouge">location_profile_rlshp</code>, <code class="language-plaintext highlighter-rouge">owner_repo_rlshp</code>, <code class="language-plaintext highlighter-rouge">related_accession_rlshp</code>, <code class="language-plaintext highlighter-rouge">related_agents_rlshp</code>, <code class="language-plaintext highlighter-rouge">resource</code>, <code class="language-plaintext highlighter-rouge">spawned_rlshp</code>, <code class="language-plaintext highlighter-rouge">surveyed_by_rlshp</code>, <code class="language-plaintext highlighter-rouge">top_container_housed_at_rlshp</code>, <code class="language-plaintext highlighter-rouge">top_container_link_rlshp</code>, <code class="language-plaintext highlighter-rouge">top_container_profile_rlshp</code></td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">restrictions_apply</code></td>
      <td> </td>
      <td><code class="language-plaintext highlighter-rouge">accession</code>, <code class="language-plaintext highlighter-rouge">archival_object</code></td>
    </tr>
  </tbody>
</table>

<!-- NEED TO ADD the restriction field here - the resource and dig ob recs have it -->
<!-- also add the hidden field in repo and the multiple restrictions in accession -->
<!-- I think this is good to mention because these are editable via the API but also have their own endpoints. So they are a little different. Should also mention that they are bools in the API docs. -->

<h2 id="read-only-fields">Read-Only Fields</h2>

<p>Several system generated, read-only fields appear across many tables. These include database identifiers, timestamps that track record creation and modification, and fields that record the username of the user that created and last modified the each record.</p>

<table>
  <thead>
    <tr>
      <th>Most common read-only fields</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">id</code> (primary key)</td>
      <td>Database identifier for each record</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">system_mtime</code></td>
      <td>The last time the record was modified by the system</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">created_by</code></td>
      <td>The user that created a record</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">last_modified_by</code></td>
      <td>The user that last modified a record</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">user_mtime</code></td>
      <td>The time that a record was last modified by a user</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">create_time</code></td>
      <td>The time that a record was created</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">lock_version</code></td>
      <td>This field is incrementally updated each time a record is updated. This provides a method of tracking updates and managing near-simultaneous edits by different users.</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">json_schema_version</code></td>
      <td>The JSON schema version</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">aspace_relationship_position</code></td>
      <td>The position of a linked record in a list of other linked records</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">is_slug_auto</code></td>
      <td>A boolean value that indicates whether a slug was auto-generated</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">system_generated</code></td>
      <td>A boolean value that indicates whether a field was system-generated</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">display_string</code></td>
      <td>A system-generated field which concatenates the title and date fields of an archival object record</td>
    </tr>
  </tbody>
</table>

<p><strong>NOTE</strong>: for subrecord tables these fields may hold unexpected data - because subrecords are deleted and recreated upon each save of a main or supporting record, their create and modification times will also be recreated and will not reflect the original creation date of the subrecord itself. For resource records, the timestamp only records the time that the resource itself was modified, not the last time any of its components were modified.</p>

<!-- ## Querying the ArchivesSpace Database -->


      </section>
      <footer>
        
        <p>This project is maintained by <a href="https://github.com/archivesspace">ArchivesSpace</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/tech-docs/assets/js/scale.fix.js"></script>
  </body>
</html>
